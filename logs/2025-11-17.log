{"timestamp":"2025-11-17T06:09:33.906Z","level":"INFO","message":"[oauth-utils] Creating or updating integration connection","meta":{"integrationId":"69184f9941fbede3df957baa","integrationKey":"facebook","userId":"test_user_id","tokenDataKeys":["access_token","refresh_token","expires_in","token_type","scope"],"hasAccessToken":true,"hasRefreshToken":true},"pid":9052}
{"timestamp":"2025-11-17T06:10:34.588Z","level":"INFO","message":"[oauth-utils] Creating or updating integration connection","meta":{"integrationId":"69184f9941fbede3df957baa","integrationKey":"facebook","userId":"test_user_id","tokenDataKeys":["access_token","refresh_token","expires_in","token_type","scope"],"hasAccessToken":true,"hasRefreshToken":true},"pid":20716}
{"timestamp":"2025-11-17T06:10:34.594Z","level":"INFO","message":"[oauth-utils] Creating new integration connection","meta":{"integrationId":"69184f9941fbede3df957baa","userId":"test_user_id"},"pid":20716}
{"timestamp":"2025-11-17T06:10:34.610Z","level":"INFO","message":"[oauth-utils] Created new integration connection and saved to database","meta":{"connectionId":"691abc5a8eb26ea64fa4cc98","integrationId":"69184f9941fbede3df957baa","userId":"test_user_id"},"pid":20716}
{"timestamp":"2025-11-17T06:24:32.292Z","level":"INFO","message":"[oauth-utils] Creating or updating integration connection","meta":{"integrationId":"69184f9941fbede3df957baa","integrationKey":"facebook","userId":"test_user_id","tokenDataKeys":["access_token","refresh_token","expires_in","token_type","scope"],"hasAccessToken":true,"hasRefreshToken":true},"pid":7884}
{"timestamp":"2025-11-17T06:24:32.296Z","level":"INFO","message":"[oauth-utils] Connection data prepared","meta":{"integrationId":"69184f9941fbede3df957baa","userId":"test_user_id","hasAccessToken":true,"hasRefreshToken":true,"expiresAt":"2025-11-17T07:24:32.295Z"},"pid":7884}
{"timestamp":"2025-11-17T06:24:32.310Z","level":"INFO","message":"[oauth-utils] Updating existing integration connection","meta":{"connectionId":"691abc5a8eb26ea64fa4cc98","integrationId":"69184f9941fbede3df957baa","userId":"test_user_id"},"pid":7884}
{"timestamp":"2025-11-17T06:24:32.351Z","level":"INFO","message":"[oauth-utils] Updated existing integration connection","meta":{"connectionId":"691abc5a8eb26ea64fa4cc98","integrationId":"69184f9941fbede3df957baa","userId":"test_user_id"},"pid":7884}
{"timestamp":"2025-11-17T06:52:01.311Z","level":"INFO","message":"[oauth-utils] Exchanging code for tokens","meta":{"integrationKey":"facebook","code":"present","redirectUri":"https://spark-frontend-production.up.railway.app/integrations/callback","clientId":"present","clientSecret":"present"},"pid":9192}
{"timestamp":"2025-11-17T06:52:01.316Z","level":"INFO","message":"[oauth-utils] OAuth token exchange request details","meta":{"integrationKey":"facebook","redirectUri":"https://spark-frontend-production.up.railway.app/integrations/callback","clientId":"23025..."},"pid":9192}
{"timestamp":"2025-11-17T06:52:01.317Z","level":"INFO","message":"[oauth-utils] Exchanging code with Facebook/Instagram","meta":{"clientId":"2302564490171864","redirectUri":"https://spark-frontend-production.up.railway.app/integrations/callback"},"pid":9192}
{"timestamp":"2025-11-17T06:52:01.753Z","level":"ERROR","message":"[integration-monitoring] Integration error recorded","meta":{"integrationKey":"facebook","errorType":"oauth/token","errorMessage":"Request failed with status code 400"},"pid":9192}
{"timestamp":"2025-11-17T06:52:01.753Z","level":"ERROR","message":"[oauth-utils] Error exchanging OAuth code for tokens","meta":{"integrationKey":"facebook","error":"Request failed with status code 400","response":{"error":{"message":"لا يمكن تحميل عنوان URL: لم يتم تضمين نطاق عنوان URL هذا في نطاقات التطبيق. للتمكن من تحميل عنوان URL هذا، يرجى إضافة كل النطاقات والنطاقات الفرعية لتطبيقك إلى الحقل \"نطاقات التطبيق\" في إعدادات التطبيق.","type":"OAuthException","code":191,"fbtrace_id":"Ap6PW39nwvi5Vzx_lLsXODG"}},"status":400,"stack":"AxiosError: Request failed with status code 400\n    at settle (c:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\node_modules\\axios\\dist\\node\\axios.cjs:2106:12)\n    at BrotliDecompress.handleStreamEnd (c:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\node_modules\\axios\\dist\\node\\axios.cjs:3491:11)\n    at BrotliDecompress.emit (node:events:524:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)\n    at Axios.request (c:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\node_modules\\axios\\dist\\node\\axios.cjs:4731:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exchangeCodeForTokens (c:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\utils\\integrations\\oauthUtils.js:51:25)\n    at async testOAuthProcess (c:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\scripts\\testOAuthProcess.js:56:25)"},"pid":9192}
{"timestamp":"2025-11-17T06:52:01.755Z","level":"INFO","message":"[oauth-utils] Connection data prepared","meta":{"integrationId":"69184f9941fbede3df957baa","userId":"test_user_id","hasAccessToken":true,"hasRefreshToken":true,"expiresAt":"2025-11-17T07:52:01.755Z"},"pid":9192}
{"timestamp":"2025-11-17T06:52:01.755Z","level":"INFO","message":"[oauth-utils] Creating or updating integration connection","meta":{"integrationId":"69184f9941fbede3df957baa","integrationKey":"facebook","userId":"test_user_id","tokenDataKeys":["access_token","refresh_token","expires_in","token_type","scope"],"hasAccessToken":true,"hasRefreshToken":true},"pid":9192}
{"timestamp":"2025-11-17T06:52:01.754Z","level":"ERROR","message":"[oauth-utils] OAuth provider error details","meta":{"integrationKey":"facebook","status":400,"statusText":"Bad Request","data":{"error":{"message":"لا يمكن تحميل عنوان URL: لم يتم تضمين نطاق عنوان URL هذا في نطاقات التطبيق. للتمكن من تحميل عنوان URL هذا، يرجى إضافة كل النطاقات والنطاقات الفرعية لتطبيقك إلى الحقل \"نطاقات التطبيق\" في إعدادات التطبيق.","type":"OAuthException","code":191,"fbtrace_id":"Ap6PW39nwvi5Vzx_lLsXODG"}}},"pid":9192}
{"timestamp":"2025-11-17T06:52:01.768Z","level":"INFO","message":"[oauth-utils] Updating existing integration connection","meta":{"connectionId":"691abc5a8eb26ea64fa4cc98","integrationId":"69184f9941fbede3df957baa","userId":"test_user_id"},"pid":9192}
{"timestamp":"2025-11-17T06:52:01.794Z","level":"INFO","message":"[oauth-utils] Updated existing integration connection","meta":{"connectionId":"691abc5a8eb26ea64fa4cc98","integrationId":"69184f9941fbede3df957baa","userId":"test_user_id"},"pid":9192}
{"timestamp":"2025-11-17T06:55:38.835Z","level":"INFO","message":"[oauth-utils] Creating or updating integration connection","meta":{"integrationId":"69184f9941fbede3df957baa","integrationKey":"facebook","userId":"69184f9941fbede3df957baa","tokenDataKeys":["access_token","refresh_token","expires_in","token_type","scope"],"hasAccessToken":true,"hasRefreshToken":true},"pid":18488}
{"timestamp":"2025-11-17T06:55:38.836Z","level":"INFO","message":"[oauth-utils] Connection data prepared","meta":{"integrationId":"69184f9941fbede3df957baa","userId":"69184f9941fbede3df957baa","hasAccessToken":true,"hasRefreshToken":true,"expiresAt":"2025-11-17T07:55:38.836Z"},"pid":18488}
{"timestamp":"2025-11-17T06:55:38.839Z","level":"INFO","message":"[oauth-utils] Creating new integration connection","meta":{"integrationId":"69184f9941fbede3df957baa","userId":"69184f9941fbede3df957baa"},"pid":18488}
{"timestamp":"2025-11-17T06:55:38.850Z","level":"INFO","message":"[oauth-utils] Created new integration connection and saved to database","meta":{"connectionId":"691ac6eac59e65115ad73266","integrationId":"69184f9941fbede3df957baa","userId":"69184f9941fbede3df957baa"},"pid":18488}
{"timestamp":"2025-11-17T07:02:57.942Z","level":"INFO","message":"[oauth-utils] Creating or updating integration connection","meta":{"integrationId":"69184f9941fbede3df957baa","integrationKey":"facebook","userId":"test_user_id","tokenDataKeys":["access_token","refresh_token","expires_in","token_type","scope"],"hasAccessToken":true,"hasRefreshToken":true},"pid":21112}
{"timestamp":"2025-11-17T07:02:57.947Z","level":"INFO","message":"[oauth-utils] Connection data prepared","meta":{"integrationId":"69184f9941fbede3df957baa","userId":"test_user_id","hasAccessToken":true,"hasRefreshToken":true,"expiresAt":"2025-11-17T08:02:57.946Z"},"pid":21112}
{"timestamp":"2025-11-17T07:02:57.963Z","level":"INFO","message":"[oauth-utils] Updating existing integration connection","meta":{"connectionId":"691abc5a8eb26ea64fa4cc98","integrationId":"69184f9941fbede3df957baa","userId":"test_user_id"},"pid":21112}
{"timestamp":"2025-11-17T07:02:58.002Z","level":"INFO","message":"[oauth-utils] Updated existing integration connection","meta":{"connectionId":"691abc5a8eb26ea64fa4cc98","integrationId":"69184f9941fbede3df957baa","userId":"test_user_id"},"pid":21112}
{"timestamp":"2025-11-17T07:14:21.099Z","level":"INFO","message":"[oauth-utils] Creating or updating integration connection","meta":{"integrationId":"69184f9a41fbede3df957bad","integrationKey":"google-drive","userId":"691acb4d292ffe2381dc1db6","tokenDataKeys":["access_token","refresh_token","expires_in","token_type","scope"],"hasAccessToken":true,"hasRefreshToken":true},"pid":24260}
{"timestamp":"2025-11-17T07:14:21.100Z","level":"INFO","message":"[oauth-utils] Connection data prepared","meta":{"integrationId":"69184f9a41fbede3df957bad","userId":"691acb4d292ffe2381dc1db6","hasAccessToken":true,"hasRefreshToken":true,"expiresAt":"2025-11-17T08:14:20.100Z"},"pid":24260}
{"timestamp":"2025-11-17T07:14:21.110Z","level":"INFO","message":"[oauth-utils] Creating new integration connection","meta":{"integrationId":"69184f9a41fbede3df957bad","userId":"691acb4d292ffe2381dc1db6"},"pid":24260}
{"timestamp":"2025-11-17T07:14:21.133Z","level":"INFO","message":"[oauth-utils] Created new integration connection and saved to database","meta":{"connectionId":"691acb4d292ffe2381dc1dba","integrationId":"69184f9a41fbede3df957bad","userId":"691acb4d292ffe2381dc1db6"},"pid":24260}
{"timestamp":"2025-11-17T07:48:40.961Z","level":"INFO","message":"[oauth-utils] Creating or updating integration connection","meta":{"integrationId":"69184f9a41fbede3df957bad","integrationKey":"google-drive","userId":"691ad3581afff04488170d46","tokenDataKeys":["access_token","refresh_token","expires_in","token_type","scope"],"hasAccessToken":true,"hasRefreshToken":true},"pid":6128}
{"timestamp":"2025-11-17T07:48:40.964Z","level":"INFO","message":"[oauth-utils] Connection data prepared","meta":{"integrationId":"69184f9a41fbede3df957bad","userId":"691ad3581afff04488170d46","hasAccessToken":true,"hasRefreshToken":true,"expiresAt":"2025-11-17T08:48:39.963Z"},"pid":6128}
{"timestamp":"2025-11-17T07:48:40.981Z","level":"INFO","message":"[oauth-utils] Creating new integration connection","meta":{"integrationId":"69184f9a41fbede3df957bad","userId":"691ad3581afff04488170d46"},"pid":6128}
{"timestamp":"2025-11-17T07:48:41.022Z","level":"INFO","message":"[oauth-utils] Created new integration connection and saved to database","meta":{"connectionId":"691ad3581afff04488170d48","integrationId":"69184f9a41fbede3df957bad","userId":"691ad3581afff04488170d46"},"pid":6128}
{"timestamp":"2025-11-17T08:04:46.344Z","level":"INFO","message":"[oauth-utils] Exchanging code for tokens","meta":{"integrationKey":"google-drive","code":"present","redirectUri":"https://spark-frontend-production.up.railway.app/integrations/callback","clientId":"present","clientSecret":"present"},"pid":18956}
{"timestamp":"2025-11-17T08:04:46.346Z","level":"INFO","message":"[oauth-utils] OAuth token exchange request details","meta":{"integrationKey":"google-drive","redirectUri":"https://spark-frontend-production.up.railway.app/integrations/callback","clientId":"81425..."},"pid":18956}
{"timestamp":"2025-11-17T08:04:46.346Z","level":"INFO","message":"[oauth-utils] Exchanging code with Google","meta":{"clientId":"814259904377-dm04gust3fffr98hsmjvjnu98hrghhaq.apps.googleusercontent.com","redirectUri":"https://spark-frontend-production.up.railway.app/integrations/callback"},"pid":18956}
{"timestamp":"2025-11-17T08:04:46.636Z","level":"ERROR","message":"[oauth-utils] Error exchanging OAuth code for tokens","meta":{"integrationKey":"google-drive","error":"Request failed with status code 401","response":{"error":"invalid_client","error_description":"Unauthorized"},"status":401,"stack":"AxiosError: Request failed with status code 401\n    at settle (c:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\node_modules\\axios\\dist\\node\\axios.cjs:2106:12)\n    at Unzip.handleStreamEnd (c:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\node_modules\\axios\\dist\\node\\axios.cjs:3491:11)\n    at Unzip.emit (node:events:524:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)\n    at Axios.request (c:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\node_modules\\axios\\dist\\node\\axios.cjs:4731:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exchangeCodeForTokens (c:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\utils\\integrations\\oauthUtils.js:80:25)\n    at async debugOAuthCallback (c:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\scripts\\debugOAuthCallback.js:65:25)"},"pid":18956}
{"timestamp":"2025-11-17T08:04:46.636Z","level":"INFO","message":"[oauth-utils] Creating or updating integration connection","meta":{"integrationId":"69184f9a41fbede3df957bad","integrationKey":"google-drive","userId":"691ad71e1f59e25b0dbfb579","tokenDataKeys":["access_token","refresh_token","expires_in","token_type","scope"],"hasAccessToken":true,"hasRefreshToken":true},"pid":18956}
{"timestamp":"2025-11-17T08:04:46.636Z","level":"INFO","message":"[oauth-utils] Connection data prepared","meta":{"integrationId":"69184f9a41fbede3df957bad","userId":"691ad71e1f59e25b0dbfb579","hasAccessToken":true,"hasRefreshToken":true,"expiresAt":"2025-11-17T09:04:46.636Z"},"pid":18956}
{"timestamp":"2025-11-17T08:04:46.635Z","level":"ERROR","message":"[integration-monitoring] Integration error recorded","meta":{"integrationKey":"google-drive","errorType":"oauth/token","errorMessage":"Request failed with status code 401"},"pid":18956}
{"timestamp":"2025-11-17T08:04:46.636Z","level":"ERROR","message":"[oauth-utils] OAuth provider error details","meta":{"integrationKey":"google-drive","status":401,"statusText":"Unauthorized","data":{"error":"invalid_client","error_description":"Unauthorized"}},"pid":18956}
{"timestamp":"2025-11-17T08:04:46.647Z","level":"INFO","message":"[oauth-utils] Creating new integration connection","meta":{"integrationId":"69184f9a41fbede3df957bad","userId":"691ad71e1f59e25b0dbfb579"},"pid":18956}
{"timestamp":"2025-11-17T08:04:46.668Z","level":"INFO","message":"[oauth-utils] Created new integration connection and saved to database","meta":{"connectionId":"691ad71e1f59e25b0dbfb57c","integrationId":"69184f9a41fbede3df957bad","userId":"691ad71e1f59e25b0dbfb579"},"pid":18956}
{"timestamp":"2025-11-17T08:43:54.398Z","level":"INFO","message":"[oauth-utils] Exchanging code for tokens","meta":{"integrationKey":"google-drive","code":"present","redirectUri":"https://spark-frontend-production.up.railway.app/integrations/callback","clientId":"present","clientSecret":"present"},"pid":18296}
{"timestamp":"2025-11-17T08:43:54.399Z","level":"INFO","message":"[oauth-utils] OAuth token exchange request details","meta":{"integrationKey":"google-drive","redirectUri":"https://spark-frontend-production.up.railway.app/integrations/callback","clientId":"81425..."},"pid":18296}
{"timestamp":"2025-11-17T08:43:54.399Z","level":"INFO","message":"[oauth-utils] Exchanging code with Google","meta":{"clientId":"814259904377-dm04gust3fffr98hsmjvjnu98hrghhaq.apps.googleusercontent.com","redirectUri":"https://spark-frontend-production.up.railway.app/integrations/callback"},"pid":18296}
{"timestamp":"2025-11-17T08:43:54.735Z","level":"ERROR","message":"[integration-monitoring] Integration error recorded","meta":{"integrationKey":"google-drive","errorType":"oauth/token","errorMessage":"Request failed with status code 401"},"pid":18296}
{"timestamp":"2025-11-17T08:43:54.735Z","level":"ERROR","message":"[oauth-utils] Error exchanging OAuth code for tokens","meta":{"integrationKey":"google-drive","error":"Request failed with status code 401","response":{"error":"invalid_client","error_description":"Unauthorized"},"status":401,"stack":"AxiosError: Request failed with status code 401\n    at settle (c:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\node_modules\\axios\\dist\\node\\axios.cjs:2106:12)\n    at Unzip.handleStreamEnd (c:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\node_modules\\axios\\dist\\node\\axios.cjs:3491:11)\n    at Unzip.emit (node:events:524:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)\n    at Axios.request (c:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\node_modules\\axios\\dist\\node\\axios.cjs:4731:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exchangeCodeForTokens (c:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\utils\\integrations\\oauthUtils.js:80:25)\n    at async debugOAuthCallback (c:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\scripts\\debugOAuthCallback.js:65:25)"},"pid":18296}
{"timestamp":"2025-11-17T08:43:54.736Z","level":"INFO","message":"[oauth-utils] Creating or updating integration connection","meta":{"integrationId":"69184f9a41fbede3df957bad","integrationKey":"google-drive","userId":"691ae04a253387d8bdfad907","tokenDataKeys":["access_token","refresh_token","expires_in","token_type","scope"],"hasAccessToken":true,"hasRefreshToken":true},"pid":18296}
{"timestamp":"2025-11-17T08:43:54.735Z","level":"ERROR","message":"[oauth-utils] OAuth provider error details","meta":{"integrationKey":"google-drive","status":401,"statusText":"Unauthorized","data":{"error":"invalid_client","error_description":"Unauthorized"}},"pid":18296}
{"timestamp":"2025-11-17T08:43:54.736Z","level":"INFO","message":"[oauth-utils] Connection data prepared","meta":{"integrationId":"69184f9a41fbede3df957bad","userId":"691ae04a253387d8bdfad907","hasAccessToken":true,"hasRefreshToken":true,"expiresAt":"2025-11-17T09:43:54.736Z"},"pid":18296}
{"timestamp":"2025-11-17T08:43:54.742Z","level":"INFO","message":"[oauth-utils] Creating new integration connection","meta":{"integrationId":"69184f9a41fbede3df957bad","userId":"691ae04a253387d8bdfad907"},"pid":18296}
{"timestamp":"2025-11-17T08:43:54.759Z","level":"INFO","message":"[oauth-utils] Created new integration connection and saved to database","meta":{"connectionId":"691ae04a253387d8bdfad90a","integrationId":"69184f9a41fbede3df957bad","userId":"691ae04a253387d8bdfad907"},"pid":18296}
{"timestamp":"2025-11-17T08:49:01.993Z","level":"INFO","message":"[oauth-utils] Creating or updating integration connection","meta":{"integrationId":"69184f9a41fbede3df957bad","integrationKey":"google-drive","userId":"69184f9941fbede3df957baa","tokenDataKeys":["access_token","refresh_token","expires_in","token_type","scope"],"hasAccessToken":true,"hasRefreshToken":true},"pid":19872}
{"timestamp":"2025-11-17T08:49:02.003Z","level":"INFO","message":"[oauth-utils] Connection data prepared","meta":{"integrationId":"69184f9a41fbede3df957bad","userId":"69184f9941fbede3df957baa","hasAccessToken":true,"hasRefreshToken":true,"expiresAt":"2025-11-17T09:49:02.002Z"},"pid":19872}
{"timestamp":"2025-11-17T08:49:02.017Z","level":"INFO","message":"[oauth-utils] Creating new integration connection","meta":{"integrationId":"69184f9a41fbede3df957bad","userId":"69184f9941fbede3df957baa"},"pid":19872}
{"timestamp":"2025-11-17T08:49:02.065Z","level":"INFO","message":"[oauth-utils] Created new integration connection and saved to database","meta":{"connectionId":"691ae17eb61c76289313377b","integrationId":"69184f9a41fbede3df957bad","userId":"69184f9941fbede3df957baa"},"pid":19872}
{"timestamp":"2025-11-17T08:50:31.833Z","level":"INFO","message":"[oauth-utils] Creating or updating integration connection","meta":{"integrationId":"69184f9a41fbede3df957bad","integrationKey":"google-drive","userId":"69184f9941fbede3df957baa","tokenDataKeys":["access_token","refresh_token","expires_in","token_type","scope"],"hasAccessToken":true,"hasRefreshToken":true},"pid":22360}
{"timestamp":"2025-11-17T08:50:31.837Z","level":"INFO","message":"[oauth-utils] Connection data prepared","meta":{"integrationId":"69184f9a41fbede3df957bad","userId":"69184f9941fbede3df957baa","hasAccessToken":true,"hasRefreshToken":true,"expiresAt":"2025-11-17T09:50:31.836Z"},"pid":22360}
{"timestamp":"2025-11-17T08:50:31.844Z","level":"INFO","message":"[oauth-utils] Updating existing integration connection","meta":{"connectionId":"691ae17eb61c76289313377b","integrationId":"69184f9a41fbede3df957bad","userId":"69184f9941fbede3df957baa"},"pid":22360}
{"timestamp":"2025-11-17T08:50:31.881Z","level":"INFO","message":"[oauth-utils] Updated existing integration connection","meta":{"connectionId":"691ae17eb61c76289313377b","integrationId":"69184f9a41fbede3df957bad","userId":"69184f9941fbede3df957baa"},"pid":22360}
{"timestamp":"2025-11-17T09:04:18.063Z","level":"INFO","message":"[oauth-utils] Creating or updating integration connection","meta":{"integrationId":"69184f9a41fbede3df957bad","integrationKey":"google-drive","userId":"6916ede023a4625ca577da28","tokenDataKeys":["access_token","refresh_token","expires_in","token_type","scope"],"hasAccessToken":true,"hasRefreshToken":true},"pid":18848}
{"timestamp":"2025-11-17T09:04:18.066Z","level":"INFO","message":"[oauth-utils] Connection data prepared","meta":{"integrationId":"69184f9a41fbede3df957bad","userId":"6916ede023a4625ca577da28","hasAccessToken":true,"hasRefreshToken":true,"expiresAt":"2025-11-17T10:04:17.066Z"},"pid":18848}
{"timestamp":"2025-11-17T09:04:18.079Z","level":"INFO","message":"[oauth-utils] Creating new integration connection","meta":{"integrationId":"69184f9a41fbede3df957bad","userId":"6916ede023a4625ca577da28"},"pid":18848}
{"timestamp":"2025-11-17T09:04:18.109Z","level":"INFO","message":"[oauth-utils] Created new integration connection and saved to database","meta":{"connectionId":"691ae51291711b730b55375c","integrationId":"69184f9a41fbede3df957bad","userId":"6916ede023a4625ca577da28"},"pid":18848}
{"timestamp":"2025-11-17T09:05:22.921Z","level":"WARN","message":"[server] Dist directory not found, skipping static file serving","meta":{},"pid":15036}
{"timestamp":"2025-11-17T09:05:23.061Z","level":"INFO","message":"[scheduled-posting-service] Scheduled posting service started","meta":{},"pid":15036}
{"timestamp":"2025-11-17T09:05:23.075Z","level":"INFO","message":"[metrics-collection-service] Metrics collection service started","meta":{},"pid":15036}
{"timestamp":"2025-11-17T09:05:23.090Z","level":"INFO","message":"[integration-monitoring-service] Integration monitoring service started","meta":{},"pid":15036}
{"timestamp":"2025-11-17T09:05:23.099Z","level":"INFO","message":"[server] Health check endpoint: http://localhost:5001/api/health","meta":{},"pid":15036}
{"timestamp":"2025-11-17T09:05:23.100Z","level":"INFO","message":"[server] Metrics endpoint: http://localhost:5001/api/metrics","meta":{},"pid":15036}
{"timestamp":"2025-11-17T09:05:23.101Z","level":"WARN","message":"[server] WARNING: Database not connected!","meta":{},"pid":15036}
{"timestamp":"2025-11-17T09:05:23.099Z","level":"INFO","message":"[server] Server is running on port 5001","meta":{},"pid":15036}
{"timestamp":"2025-11-17T09:05:23.102Z","level":"WARN","message":"[server] Some features may not work properly.","meta":{},"pid":15036}
{"timestamp":"2025-11-17T09:05:23.102Z","level":"WARN","message":"[server] Please check your MongoDB installation or database configuration.","meta":{},"pid":15036}
{"timestamp":"2025-11-17T09:05:23.162Z","level":"INFO","message":"[server] Database connected successfully","meta":{},"pid":15036}
{"timestamp":"2025-11-17T09:05:23.373Z","level":"INFO","message":"[server] Found 5 existing integrations, skipping initialization","meta":{},"pid":15036}
{"timestamp":"2025-11-17T09:05:39.487Z","level":"INFO","message":"[server] Incoming request","meta":{"method":"POST","url":"/api/integrations/exchange","ip":"::1","userAgent":"axios/1.13.2"},"pid":15036}
{"timestamp":"2025-11-17T09:05:39.491Z","level":"WARN","message":"[monitoring] HTTP error response","meta":{"method":"POST","url":"/exchange","statusCode":401,"ip":"::1"},"pid":15036}
{"timestamp":"2025-11-17T09:06:57.891Z","level":"WARN","message":"[server] Dist directory not found, skipping static file serving","meta":{},"pid":3344}
{"timestamp":"2025-11-17T09:06:57.910Z","level":"INFO","message":"[scheduled-posting-service] Scheduled posting service started","meta":{},"pid":3344}
{"timestamp":"2025-11-17T09:06:57.913Z","level":"INFO","message":"[metrics-collection-service] Metrics collection service started","meta":{},"pid":3344}
{"timestamp":"2025-11-17T09:06:57.915Z","level":"INFO","message":"[integration-monitoring-service] Integration monitoring service started","meta":{},"pid":3344}
{"timestamp":"2025-11-17T09:06:57.918Z","level":"INFO","message":"[server] Server is running on port 5001","meta":{},"pid":3344}
{"timestamp":"2025-11-17T09:06:57.918Z","level":"INFO","message":"[server] Health check endpoint: http://localhost:5001/api/health","meta":{},"pid":3344}
{"timestamp":"2025-11-17T09:06:57.919Z","level":"INFO","message":"[server] Metrics endpoint: http://localhost:5001/api/metrics","meta":{},"pid":3344}
{"timestamp":"2025-11-17T09:06:57.920Z","level":"WARN","message":"[server] WARNING: Database not connected!","meta":{},"pid":3344}
{"timestamp":"2025-11-17T09:06:57.920Z","level":"WARN","message":"[server] Some features may not work properly.","meta":{},"pid":3344}
{"timestamp":"2025-11-17T09:06:57.921Z","level":"WARN","message":"[server] Please check your MongoDB installation or database configuration.","meta":{},"pid":3344}
{"timestamp":"2025-11-17T09:06:57.940Z","level":"INFO","message":"[server] Database connected successfully","meta":{},"pid":3344}
{"timestamp":"2025-11-17T09:06:57.995Z","level":"INFO","message":"[server] Found 5 existing integrations, skipping initialization","meta":{},"pid":3344}
{"timestamp":"2025-11-17T09:07:25.897Z","level":"INFO","message":"[server] Incoming request","meta":{"method":"POST","url":"/api/integrations/exchange","ip":"::1","userAgent":"axios/1.13.2"},"pid":3344}
{"timestamp":"2025-11-17T09:07:25.917Z","level":"INFO","message":"[integration-controller] Found integration for token exchange","meta":{"integrationKey":"google-drive","integrationName":"Google Drive"},"pid":3344}
{"timestamp":"2025-11-17T09:07:25.917Z","level":"INFO","message":"[integration-controller] Using redirect URI for token exchange","meta":{"finalRedirectUri":"http://localhost:5173/integrations/callback","providedRedirectUri":"http://localhost:5173/integrations/callback","integrationRedirectUri":"http://localhost:5173/integrations/callback"},"pid":3344}
{"timestamp":"2025-11-17T09:07:25.918Z","level":"INFO","message":"[integration-controller] Attempting to exchange code for tokens","meta":{"integrationKey":"google-drive"},"pid":3344}
{"timestamp":"2025-11-17T09:07:25.932Z","level":"INFO","message":"[oauth-utils] Exchanging code for tokens","meta":{"integrationKey":"google-drive","code":"present","redirectUri":"http://localhost:5173/integrations/callback","clientId":"present","clientSecret":"present"},"pid":3344}
{"timestamp":"2025-11-17T09:07:25.933Z","level":"INFO","message":"[oauth-utils] Exchanging code with Google","meta":{"clientId":"814259904377-dm04gust3fffr98hsmjvjnu98hrghhaq.apps.googleusercontent.com","redirectUri":"http://localhost:5173/integrations/callback"},"pid":3344}
{"timestamp":"2025-11-17T09:07:25.932Z","level":"INFO","message":"[oauth-utils] OAuth token exchange request details","meta":{"integrationKey":"google-drive","redirectUri":"http://localhost:5173/integrations/callback","clientId":"81425..."},"pid":3344}
{"timestamp":"2025-11-17T09:07:26.268Z","level":"ERROR","message":"[integration-monitoring] Integration error recorded","meta":{"integrationKey":"google-drive","errorType":"oauth/token","errorMessage":"Request failed with status code 401"},"pid":3344}
{"timestamp":"2025-11-17T09:07:26.268Z","level":"ERROR","message":"[oauth-utils] Error exchanging OAuth code for tokens","meta":{"integrationKey":"google-drive","error":"Request failed with status code 401","response":{"error":"invalid_client","error_description":"Unauthorized"},"status":401,"stack":"AxiosError: Request failed with status code 401\n    at settle (C:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\node_modules\\axios\\dist\\node\\axios.cjs:2106:12)\n    at Unzip.handleStreamEnd (C:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\node_modules\\axios\\dist\\node\\axios.cjs:3491:11)\n    at Unzip.emit (node:events:524:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)\n    at Axios.request (C:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\node_modules\\axios\\dist\\node\\axios.cjs:4731:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exchangeCodeForTokens (C:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\utils\\integrations\\oauthUtils.js:80:25)\n    at async C:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\controllers\\integrationController.js:248:23"},"pid":3344}
{"timestamp":"2025-11-17T09:07:26.272Z","level":"WARN","message":"[monitoring] HTTP error response","meta":{"method":"POST","url":"/exchange","statusCode":500,"ip":"::1"},"pid":3344}
{"timestamp":"2025-11-17T09:07:26.269Z","level":"ERROR","message":"[oauth-utils] OAuth provider error details","meta":{"integrationKey":"google-drive","status":401,"statusText":"Unauthorized","data":{"error":"invalid_client","error_description":"Unauthorized"}},"pid":3344}
{"timestamp":"2025-11-17T09:07:26.269Z","level":"ERROR","message":"[integration-controller] Error during token exchange","meta":{"integrationKey":"google-drive","error":"OAuth provider error (401): {\"error\":\"invalid_client\",\"error_description\":\"Unauthorized\"}","stack":"Error: OAuth provider error (401): {\"error\":\"invalid_client\",\"error_description\":\"Unauthorized\"}\n    at exchangeCodeForTokens (C:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\utils\\integrations\\oauthUtils.js:140:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async C:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\controllers\\integrationController.js:248:23"},"pid":3344}
{"timestamp":"2025-11-17T09:08:59.521Z","level":"INFO","message":"[server] Incoming request","meta":{"method":"POST","url":"/api/integrations/exchange","ip":"::1","userAgent":"axios/1.13.2"},"pid":3344}
{"timestamp":"2025-11-17T09:08:59.525Z","level":"INFO","message":"[integration-controller] Found integration for token exchange","meta":{"integrationKey":"google-drive","integrationName":"Google Drive"},"pid":3344}
{"timestamp":"2025-11-17T09:08:59.526Z","level":"INFO","message":"[integration-controller] Using redirect URI for token exchange","meta":{"finalRedirectUri":"http://localhost:5173/integrations/callback","providedRedirectUri":"http://localhost:5173/integrations/callback","integrationRedirectUri":"http://localhost:5173/integrations/callback"},"pid":3344}
{"timestamp":"2025-11-17T09:08:59.526Z","level":"INFO","message":"[integration-controller] Attempting to exchange code for tokens","meta":{"integrationKey":"google-drive"},"pid":3344}
{"timestamp":"2025-11-17T09:08:59.529Z","level":"INFO","message":"[oauth-utils] Exchanging code for tokens","meta":{"integrationKey":"google-drive","code":"present","redirectUri":"http://localhost:5173/integrations/callback","clientId":"present","clientSecret":"present"},"pid":3344}
{"timestamp":"2025-11-17T09:08:59.530Z","level":"INFO","message":"[oauth-utils] Exchanging code with Google","meta":{"clientId":"814259904377-dm04gust3fffr98hsmjvjnu98hrghhaq.apps.googleusercontent.com","redirectUri":"http://localhost:5173/integrations/callback"},"pid":3344}
{"timestamp":"2025-11-17T09:08:59.529Z","level":"INFO","message":"[oauth-utils] OAuth token exchange request details","meta":{"integrationKey":"google-drive","redirectUri":"http://localhost:5173/integrations/callback","clientId":"81425..."},"pid":3344}
{"timestamp":"2025-11-17T09:08:59.777Z","level":"ERROR","message":"[integration-monitoring] Integration error recorded","meta":{"integrationKey":"google-drive","errorType":"oauth/token","errorMessage":"Request failed with status code 401"},"pid":3344}
{"timestamp":"2025-11-17T09:08:59.777Z","level":"ERROR","message":"[oauth-utils] Error exchanging OAuth code for tokens","meta":{"integrationKey":"google-drive","error":"Request failed with status code 401","response":{"error":"invalid_client","error_description":"Unauthorized"},"status":401,"stack":"AxiosError: Request failed with status code 401\n    at settle (C:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\node_modules\\axios\\dist\\node\\axios.cjs:2106:12)\n    at Unzip.handleStreamEnd (C:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\node_modules\\axios\\dist\\node\\axios.cjs:3491:11)\n    at Unzip.emit (node:events:524:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)\n    at Axios.request (C:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\node_modules\\axios\\dist\\node\\axios.cjs:4731:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async exchangeCodeForTokens (C:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\utils\\integrations\\oauthUtils.js:80:25)\n    at async C:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\controllers\\integrationController.js:248:23"},"pid":3344}
{"timestamp":"2025-11-17T09:08:59.778Z","level":"WARN","message":"[monitoring] HTTP error response","meta":{"method":"POST","url":"/exchange","statusCode":500,"ip":"::1"},"pid":3344}
{"timestamp":"2025-11-17T09:08:59.777Z","level":"ERROR","message":"[oauth-utils] OAuth provider error details","meta":{"integrationKey":"google-drive","status":401,"statusText":"Unauthorized","data":{"error":"invalid_client","error_description":"Unauthorized"}},"pid":3344}
{"timestamp":"2025-11-17T09:08:59.778Z","level":"ERROR","message":"[integration-controller] Error during token exchange","meta":{"integrationKey":"google-drive","error":"OAuth provider error (401): {\"error\":\"invalid_client\",\"error_description\":\"Unauthorized\"}","stack":"Error: OAuth provider error (401): {\"error\":\"invalid_client\",\"error_description\":\"Unauthorized\"}\n    at exchangeCodeForTokens (C:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\utils\\integrations\\oauthUtils.js:140:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async C:\\Users\\user\\Downloads\\winnerforce-spark-main\\clean-project\\Spark-backend\\controllers\\integrationController.js:248:23"},"pid":3344}
